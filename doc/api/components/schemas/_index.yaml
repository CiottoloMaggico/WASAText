CustomInt64:
  description: Custom integer64 type to avoid minimum and maximum error
  type: integer
  format: int64
  minimum: 0
  maximum: 9007199254740991

CustomInt32:
  description: Custom integer32 type to avoid minimum and maximum error
  type: integer
  format: int32
  minimum: 0
  maximum: 2147483647

ReadOnlyInt64:
  description: Custom integer64 readonly type to avoid minimum and maximum error
  type: integer
  format: int64
  minimum: 0
  maximum: 9007199254740991
  readOnly: true

ReadOnlyInt32:
  description: Custom integer32 readonly type to avoid minimum and maximum error
  type: integer
  format: int32
  minimum: 0
  maximum: 2147483647
  readOnly: true

ReadOnlyUrl:
  description: Custom string type to use for urls
  type: string
  format: url
  readOnly: true

Username:
  description: users "Username" field type
  type: string
  format: identifier
  minLength: 1
  maxLength: 16

ConversationName:
  description: conversations "name" field type
  type: string
  minLength: 1
  maxLength: 16

ConversationType:
  description: conversations type to specify its type
  type: string
  enum: [ "group", "one_to_one" ]
  readOnly: true

MessageStatus:
  description: list of possible statuses of a message
  type: string
  enum: [ "sent", "delivered", "read" ]
  default: "sent"

HttpStatusCode:
  description: http status code type
  type: integer
  format: int32
  minimum: 100
  maximum: 599
  readOnly: true

PaginationOffset:
  description: used to specify how many items per page are displayed in paginated responses
  type: integer
  format: int32
  minimum: 0
  maximum: 20
  default: 20

User:
  description: User type
  type: object
  properties:
    username:
      $ref: "#/Username"
    photo:
      $ref: "#/Image"

Image:
  description: Image type
  type: object
  properties:
    id:
      $ref: "#/CustomInt64"
    width:
      $ref: "#/CustomInt32"
    height:
      $ref: "#/CustomInt32"
    fullUrl:
      $ref: "#/ReadOnlyUrl"

Conversation:
  description: Conversation type
  type: object
  required: [ "id", "name", "photo", "type" ]
  properties:
    id:
      $ref: "#/CustomInt64"
    name:
      $ref: "#/ConversationName"
    photo:
      $ref: "#/Image"
    type:
      $ref: "#/ConversationType"
    latestMessage:
      $ref: "#/Message"

ConversationDetail:
  description: Conversation type for detailed info about a conversation
  type: object
  required: [ "participants" ]
  properties:
    participants:
      type: array
      readOnly: true
      uniqueItems: true
      minItems: 1
      maxItems: 200
      items:
        $ref: "#/Username"

ConversationDetailMerge:
  description: Merge type between Conversation and ConversationDetail
  type: object
  allOf:
    - $ref: "#/Conversation"
    - $ref: "#/ConversationDetail"

Message:
  description: Message type
  type: object
  required: [ "id", "conversationId", "authorId", "sendAt", "status" ]
  properties:
    id:
      $ref: "#/CustomInt64"
    conversationId:
      $ref: "#/CustomInt64"
    authorId:
      $ref: "#/CustomInt64"
    sendAt:
      type: string
      format: date-time
      readOnly: true
    status:
      $ref: "#/MessageStatus"
    repliedMessageId:
      $ref: "#/CustomInt64"
    attachmentUrl:
      $ref: "#/ReadOnlyUrl"
    content:
      type: string

Comment:
  description: Comment type
  type: object
  properties:
    id:
      $ref: "#/CustomInt64"
    messageId:
      $ref: "#/CustomInt64"
    authorId:
      $ref: "#/CustomInt64"
    content:
      type: string

HttpStatus:
  description: Blueprint for responses without content or http errors
  type: object
  required: [ "code", "message" ]
  properties:
    code:
      $ref: "#/HttpStatusCode"
    message:
      type: string
    description:
      type: string

Pagination:
  description: Blueprint used in paginated responses
  type: object
  required: [ "page" ]
  properties:
    page:
      $ref: "#/ReadOnlyInt32"
    nextPage:
      $ref: "#/ReadOnlyUrl"
    previousPage:
      $ref: "#/ReadOnlyUrl"
